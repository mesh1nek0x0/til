# ethernet（イーサネット）
名前がインターネットと似ているなぁと常々思っていました。

関連があるいえばありますが、実のところLANの規格です。

もともとIEEEが規格化したものではなく、DIX-Ethernetという1970年代の末期に開発されていたものを標準化して

IEEE802.3というのができたらしい。IEEE802.3とイーサネットがほぼ同一なのはそういうわけらしいです。

なお、イーサネットはLANの規格としては以下が定められているようです。
* 同軸ケーブル（今は普及してない）
* CSMA/CDアクセス制御方式
* バス型・スター型物理トポロジ

## イーサネットのframeの構造
通信する際、上位層のパケットデータにL2の情報を付与してフレームというデータユニットで転送をします。

このときパケットの先頭につくのがパケットヘッダ、お尻につくのがパケットトレーラーと呼ぶらしい。

フッタではないんですね。

* プリアンプル（8byte)
 * ここからフレームですよ
* 宛先MACアドレス(6byte)
* 送信元MACアドレス(6byte)
* フレームタイプ(3byte)
 * レイヤ3以上のプロトコルが入るらしいL2なのに？
* パケット(46~1500byte)
* FCS(4byte)
 * Frame Check Sequence　エラーチェック用

## イーサネットの特徴
ブロードキャスト通信のため、フレームはNICを通してすべてのメディア上へ送信され、全ノードへ到達する。

### 衝突検知のためのCSMA/CD
ブロードキャストだと、単純にフレームをどんどん流してしまうため、

複数のノードがリンクしているネットワークでは通信がガンガンぶつかってしまう可能性あります。

その問題の解決策として用意しているのがCSMA/CDアクセス制御方式です。

なお、名称は以下の略称です。
* キャリア検知（Carrier Sense）
 * 誰か送信中じゃないかチェック！
* 多重アクセス（Multiple Access）
 * 送信してなかったら誰でも送信開始してOK！
* 衝突検知（Collision Detection）
 * 同時に気づいたら送信ストップ

通信の手順としては
* 送信準備
 * イーサネットフレームを作成して、衝突カウンタを0にする
* CSMA
 * 一定時間待って誰も送信していなければ送信開始。流れてくるものはキャリア信号という。
* CD
 * 衝突検知です。衝突がなければ終了。衝突があればJAM信号を送信。
 * JAM信号は今受け取ったフレームを破棄してーという信号らしい
* バックオフ
 * 再送信待ちです。衝突カウンタを++して16未満なら待機して再送信を図る
 * 待機時間はバックオフ時間。そのまま。

### ベストエフォート型配送（最善努力型配送）
確実に届けるけど、あとのことはシラネ！

送信した側にはどうなったかはわからないのが特徴。

ちなみに受信側は自分の宛先じゃなかったら破棄しているだけ。
