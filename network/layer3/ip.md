# layer3 ip
internet protocolの略

インターネットで使用されるプロトコルの１つ。論理アドレスの決定と経路の決定を行いパケット転送の役割を受け持つ。

転送方法はベストエフォート型で転送についての保障は行わない。

TCP/IPとセットで紹介されるが、それぞれ別々のプロトコルです。

このような複数のプロトコルを１つの思想としてまとめたものをプロトコルスイートやプロトコルスタックと呼ぶようです。

スイートというのはテストスイートとかもあるし、馴染みありますね。

※他のlayer3 プロトコルについて
TCP/IP以外でよく知られているのはIPX/SPXやAppleTalkなどがある。


## IPヘッダ
セグメントデータにヘッダデータ(20~60byte)を付与する。フレームにつけたヘッダ・トレーラのようなトレーラは存在しない。

ヘッダは20byte+オプション40byteで構成され、最初の20byte=160bitで重要のなのは以下の３つが大事。

### TTL
Time To Liveの略。パケットの生存時間。永遠にパケットがぐるぐるするのを防ぐ仕組み。

### 送信元IPアドレス
送信元の論理アドレス(32bit)

### 送信先IPアドレス
宛先の論理アドレス(32bit)

その他見かけそうなヘッダの中身

* バージョン
 * v4とかv6かな
* ヘッダチェックサム
 * IPヘッダのエラーチェック

## 論理アドレス
いわゆるIPアドレスがこれの１つにあたる。

ベンダが発行したあと変更できない物理アドレスと異なり、ネットワーク管理者が自由に付け替えらるのが特徴。

各デバイスとネットワークの接続点ごとに付与する。

tips. NICを差し替えても同じIPを割り当てることは可能なので、NICごとではない

プロトコルによって論理アドレスの体系が変わるため、プロトコルが違う場合は変換が必要になる。

* IP(TCP/IP)
 * 192.168.33.100
* IPX(IPX/SPX)
 * 4d.0060.3e86.e220
* DDP(AppleTalk)
 * 151.10

### 論理アドレスの構成
ネットワークアドレス＋ホスト番号という構成になっている。

管理するネットワークの大きさによって32bitのうちどこまでをネットワークアドレス、どこからをホスト番号にするという形で決める。

これは何処の誰？を明確にするためであり、「何処」は接続されているネットワーク内でユニークである必要があります。

※接続されていなければ、ユニークでなくも問題ない

## IPアドレス
IPで使われるアドレスなのでIPアドレス。単純。

MACアドレスは48bitでしたが、IPアドレス（v4）は32bitです。v6になると128bitまで拡張されるようです。

ただ、人間にはとても読みにくいため、8bitごとに4つに区切って（4つのオクテット）10進数で表記する。
